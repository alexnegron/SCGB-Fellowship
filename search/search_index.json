{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Home \u00b6 To do list \u00b6 item","title":"Home"},{"location":"#home","text":"","title":"Home"},{"location":"#to-do-list","text":"item","title":"To do list"},{"location":"Long-time%20covariance%20calculation/","text":"\\[ \\DeclareMathOperator{\\Cov}{Cov} \\DeclareMathOperator{\\Corr}{Corr} \\DeclareMathOperator{\\Var}{Var} \\DeclareMathOperator{\\prob}{\\mathbb{P}} \\DeclareMathOperator{\\qprob}{\\mathbb{Q}} \\DeclareMathOperator{\\E}{\\mathbb{E}} \\newcommand{\\set}[1]{\\left\\{#1\\right\\}} \\newcommand{\\pa}[1]{\\left(#1\\right)} \\newcommand{\\ang}[1]{\\left<#1\\right>} \\newcommand{\\bra}[1]{\\left[#1\\right]} \\newcommand{\\abs}[1]{\\left|#1\\right|} \\newcommand{\\norm}[1]{\\left\\|#1\\right\\|} \\] Long-time covariance calculation \u00b6 In [[Three unit rate model|the note defining the rate model]], we wrote down a linear SDE characterizing the dynamics of the fluctuations \\(\\delta \\mathbf{r}.\\) This SDE is given by \\[ \\tau_i \\dot{r}_i(t) = - r_i(t) + \\bra{\\mu_i + \\sum_{j\\in\\set{E_1,E_2,I}}W_{ij}r_j(t) + \\sqrt{2\\sigma_i}\\xi_i(t)}_+, \\qquad \\text{for }i \\in \\set{E_1,E_2,I} \\] The solution is obtained as \\[ \\delta \\mathbf{r}(t) = \\exp\\left\\{-\\mathbf{M}t\\right\\}\\delta\\mathbf{r}(0) + \\int_{-\\infty}^{t}\\exp\\left\\{-\\mathbf{M}\\pa{t-t'}\\right\\}\\mathbf{D}\\ \\underbrace{d\\mathbf{W}(t')}_{\\boldsymbol{\\xi}(t')} \\] with mean \\(\\ang{\\delta \\mathbf{r}(t)} = \\exp\\set{-\\mathbf{M}t}\\ang{\\delta \\mathbf{r}(0)}\\) (expectation of integral is given by an Ito integral property ). Long-time covariance function. \u00b6 We now compute the \\(t\\to \\infty\\) covariance function. Observe \\(\\lim_{t \\to \\infty} \\ang{\\delta \\mathbf{r}(t)} = 0\\) (see the Remark below for the details about this calculation). As an operator, \\(\\Cov(\\cdot, \\cdot)\\) is shift-invariant in each argument, thus \\[\\Cov(\\mathbf{r}(t), \\mathbf{r}(s)) = \\Cov(\\mathbf{r}(t)-\\mathbf{\\bar{r}}, \\mathbf{r}(s)-\\mathbf{\\bar{r}}) = \\Cov(\\delta \\mathbf{r}(t), \\delta\\mathbf{r}(s)).\\] Hence in the following calculations, for notational simplicity, we will use \\(\\mathbf{r}(t)\\) in place of \\(\\delta \\mathbf{r}(t)\\) . We make the notations \\[\\Cov(\\mathbf{r}(t), \\mathbf{r}(s)) =: \\ang{\\mathbf{r}(t), \\mathbf{r}(s)} = \\E\\bra{\\pa{\\mathbf{r}(t)-\\E\\bra{\\mathbf{r}(t)}}\\pa{\\mathbf{r}(s)-\\E\\bra{\\mathbf{r}(s)}}^\\top} = \\ang{\\pa{\\mathbf{r}(t) - \\ang{\\mathbf{r}(t)}}\\pa{\\mathbf{r}(s) - \\ang{\\mathbf{r}(s)}}^\\top}.\\] For \\(s=t+\\tau\\) where \\(\\tau > 0\\) , we have \\[\\begin{aligned} \\ang{\\pa{\\mathbf{r}(t)-\\ang{\\mathbf{r}(t)}}\\pa{\\mathbf{r}(t+\\tau)-\\ang{\\mathbf{r}(t+\\tau)}}^\\top} &= \\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(t+\\tau)-\\ang{\\mathbf{r}(t)}\\mathbf{r}^{\\top}(t+\\tau) - \\mathbf{r}(t)\\ang{\\mathbf{r}(t+\\tau)}^{\\top} + \\ang{\\mathbf{r}(t)}\\ang{\\mathbf{r}(t+\\tau)}^{\\top}}\\\\ &= \\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(t+\\tau)} - 2\\underbrace{\\ang{\\mathbf{r}(t)}\\ang{\\mathbf{r}^{\\top}(t+\\tau)}}_{\\xrightarrow[t\\to\\infty]{}0} + \\underbrace{\\ang{\\mathbf{r}(t)}\\ang{\\mathbf{r}(t+\\tau)}^{\\top}}_{\\xrightarrow[t\\to\\infty]{}0}, \\end{aligned} \\] which implies that the long-time covariance function is the \\(t\\to \\infty\\) limit of \\(\\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(t+\\tau)}\\) : \\[ \\begin{aligned} \\lim_{t\\to \\infty} \\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(t+\\tau)} &= \\lim_{t\\to\\infty} \\ang{ \\int_{-\\infty}^{t}\\int_{-\\infty}^{t+\\tau} \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D} \\pmb{\\xi}(t') \\pa{\\exp\\set{-\\mathbf{M}\\pa{t+\\tau-t''}}\\mathbf{D} \\pmb{\\xi}(t'')}^\\top \\ dt'' \\ dt' }\\\\ &= \\lim_{t\\to \\infty} \\int_{-\\infty}^{t}\\int_{-\\infty}^{t+\\tau} \\ang{ \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D} \\pmb{\\xi}(t') \\pmb{\\xi}^{\\top}(t'')\\mathbf{D}^{\\top}\\exp\\set{-\\mathbf{M}^{\\top}(t+\\tau-t'')}} \\ dt'' \\ dt' \\\\ &= \\lim_{t\\to \\infty} \\int_{-\\infty}^{t}\\int_{-\\infty}^{t+\\tau} \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D} \\ang{\\pmb{\\xi}(t') \\pmb{\\xi}^{\\top}(t'')}\\mathbf{D}^{\\top}\\exp\\set{-\\mathbf{M}^{\\top}(t+\\tau-t'')} \\ dt'' \\ dt' \\\\ &= \\lim_{t\\to\\infty} \\int_{-\\infty}^{t} \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D}\\mathbf{D}^{\\top}\\exp\\set{-\\mathbf{M}^{\\top}(t+\\tau-t')} \\ dt', \\end{aligned} \\] where in the last line we used that the white noise process \\(\\boldsymbol{\\xi}(t)\\) has a \\(\\delta\\) correlation in time. The Lyapunov equation. \u00b6 Let \\(\\pmb{\\Sigma}:=\\ang{\\mathbf{r}(t),\\mathbf{r}^\\top(t)}\\) be the (instantaneous, at each \\(t\\) ) stationary covariance matrix. We may evaluate this quantity algebraically as \\[ \\begin{aligned} \\mathbf{M}\\pmb{\\Sigma} + \\pmb{\\Sigma}\\mathbf{M}^{\\top} &= \\int_{-\\infty}^{t}\\mathbf{M} \\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\mathbf{D}\\mathbf{D}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')} \\ dt' \\\\ &\\qquad \\qquad + \\int_{-\\infty}^{t} \\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\mathbf{D}\\mathbf{D}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')}\\mathbf{M}^{\\top} \\ dt'\\\\ &= \\int_{-\\infty}^{t} \\frac{d}{dt'}\\bra{\\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\mathbf{D}\\mathbf{D}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')}} \\ dt' \\\\ &= \\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\mathbf{D}\\mathbf{D}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')}\\Bigg|_{t'\\to -\\infty}^{t'=t} \\\\ &=\\exp\\set{0}\\mathbf{D}\\mathbf{D}^{\\top}\\exp\\set{0} - \\lim_{t'\\to -\\infty} \\pa{\\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\mathbf{D}\\mathbf{D}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')}}\\\\ &=\\mathbf{D}\\mathbf{D}^\\top. \\end{aligned} \\] This is called the Lyapunov equation . Remark In the last equality, we take limits \\lim_{t' \\to -\\infty} \\exp\\set{-\\mathbf{M}(t-t')} \\qquad \\text{and} \\qquad \\lim_{t' \\to -\\infty} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')} which is equivalent to looking at \\(\\lim\\limits_{t\\to \\infty} e^{\\mathbf{M}t}\\) . Suppose \\(\\mathbf{M}\\) is diagonalizable: \\mathbf{M} = \\mathbf{U}^{-1}\\boldsymbol{\\Lambda}\\mathbf{U}, \\qquad \\boldsymbol{\\Lambda} = \\text{diag}\\pa{\\lambda_1,\\lambda_2,\\ldots,\\lambda_n} Then e^{t\\mathbf{M}} = \\mathbf{U}^{-1}e^{t\\boldsymbol{\\Lambda}}\\mathbf{U} = \\mathbf{U}^{-1}\\pa{\\text{diag}\\pa{e^{\\lambda_1t},e^{\\lambda_2t},\\ldots,e^{\\lambda_n t}}}\\mathbf{U}. This expression shows that the convergence as \\(t\\to \\infty\\) depends on eigenvalues. In particular, we need their real parts to be \\(<0\\) . In this case, \\(e^{t\\mathbf{A}} \\xrightarrow[t\\to\\infty]{} 0\\) . Because we assume the network is stable, \\(\\mathbf{M}\\) must have eigenvalues with positive real part. ^adf0fd Time correlation matrix in stationary state. \u00b6 As computed above and using the fact that \\(\\mathbf{DD}^{\\top}= \\mathbf{M}\\bf{\\Sigma} + \\bf{\\Sigma}\\bf{M}^\\top\\) , if \\(t > s\\) , \\[ \\begin{aligned} \\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(s)} &= \\int_{-\\infty}^{s} \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D}\\mathbf{D}^{\\top}\\exp\\set{-\\mathbf{M}^{\\top}(s-t')} \\ dt' \\\\ &= \\int_{-\\infty}^{s} \\exp\\set{-\\mathbf{M}(t-t')} \\mathbf{M}\\boldsymbol{\\Sigma} \\exp\\set{-\\mathbf{M}^{\\top}(s-t')} \\ dt' \\\\ &\\qquad \\qquad + \\int_{-\\infty}^{s}\\exp\\set{-\\mathbf{M}(t-t')} \\boldsymbol{\\Sigma}\\mathbf{M}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(s-t')} \\ dt'\\\\ &= \\int_{-\\infty}^{s} \\frac{d}{dt'} \\bra{\\exp\\set{-\\mathbf{M}(t-t')}\\boldsymbol{\\Sigma} \\exp\\set{-\\mathbf{M}^{\\top}(s-t')}} \\ dt' \\\\ &= \\exp\\set{-\\mathbf{M}\\pa{t-s}}\\boldsymbol{\\Sigma} - \\lim_{t'\\to-\\infty} \\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\boldsymbol{\\Sigma} \\exp\\set{-\\mathbf{M}^\\top\\pa{s-t'}}\\\\ &= \\exp\\set{-\\mathbf{M}\\pa{t-s}}\\boldsymbol{\\Sigma}. \\end{aligned} \\] Likewise, if \\(s > t\\) , \\[\\begin{aligned} \\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(s)} &= \\int_{-\\infty}^{t} \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D}\\mathbf{D}^{\\top}\\exp\\set{-\\mathbf{M}^{\\top}(s-t')} \\ dt' \\\\ &= \\int_{-\\infty}^{t} \\frac{d}{dt'} \\bra{\\exp\\set{-\\mathbf{M}(t-t')}\\boldsymbol{\\Sigma} \\exp\\set{-\\mathbf{M}^{\\top}(s-t')}} \\ dt' \\\\ &= \\boldsymbol{\\Sigma}\\exp\\set{-\\mathbf{M}^{\\top}(s-t)}. \\end{aligned}\\] Note As expected of a stationary solution, the correlation function depends only on time lag \\(h=|s-t|\\) . Define \\(\\widetilde{\\mathbf{C}}(t-s) = \\ang{\\mathbf{r}(t),\\mathbf{r}^{\\top}(s)}\\) . If \\(h = s-t\\) , Then we may write \\[ \\widetilde{\\mathbf{C}}(h) = \\begin{cases} \\exp\\set{\\mathbf{M}h}\\boldsymbol{\\Sigma}, & h <0\\\\[10pt] \\boldsymbol{\\Sigma}\\exp\\set{-\\mathbf{M}^{\\top}h}, & h > 0 \\end{cases} \\] Long-time covariance matrix. \u00b6 The spectrum matrix is the Fourier transform of the correlation matrix, \\[ \\begin{aligned} \\mathbf{S}(\\omega) = \\int_{-\\infty}^{\\infty} e^{-2\\pi i\\omega h} \\widetilde{\\mathbf{C}}(h)\\ dh. \\end{aligned} \\] Then \\(\\mathbf{S}(0)=\\int_{-\\infty}^\\infty \\mathbf{\\tilde{C}}(h) \\ dh\\) . We may also compute this as follows: \\[\\begin{aligned} \\mathbf{S}(0) &= \\int_0^{\\infty} \\boldsymbol{\\Sigma}\\exp\\set{-\\mathbf{M}^{\\top}h} \\ dh + \\int_{-\\infty}^{0}\\exp\\set{\\mathbf{M}h}\\boldsymbol{\\Sigma} \\ dh \\\\ &= \\boldsymbol{\\Sigma}\\pa{\\mathbf{M}^{\\top}}^{-1} + \\mathbf{M}^{-1}\\boldsymbol{\\Sigma}, \\end{aligned}\\] and so \\[\\mathbf{M}\\mathbf{S}(0)\\mathbf{M}^{\\top} = \\mathbf{M}\\boldsymbol{\\Sigma} + \\boldsymbol{\\Sigma}\\mathbf{M}^{\\top}= \\mathbf{DD}^\\top\\] This gives \\[ \\int_{-\\infty}^{\\infty} \\widetilde{\\mathbf{C}}(h) \\ dh =\\mathbf{S}(0) = \\mathbf{M}^{-1}\\mathbf{D}\\mathbf{D}^\\top\\pa{\\mathbf{M}^{\\top}}^{-1} = \\mathbf{M}^{-1}\\mathbf{D}\\pa{\\mathbf{M}^{-1}\\mathbf{D}}^\\top. \\] We define the long-time covariance precisely this quantity: \\[ \\mathbf{C}:=\\int_{-\\infty}^{\\infty} \\widetilde{\\mathbf{C}}(h) \\ dh = \\mathbf{M}^{-1}\\mathbf{D}\\pa{\\mathbf{M}^{-1}\\mathbf{D}}^\\top. \\]","title":"Long time covariance calculation"},{"location":"Long-time%20covariance%20calculation/#long-time-covariance-calculation","text":"In [[Three unit rate model|the note defining the rate model]], we wrote down a linear SDE characterizing the dynamics of the fluctuations \\(\\delta \\mathbf{r}.\\) This SDE is given by \\[ \\tau_i \\dot{r}_i(t) = - r_i(t) + \\bra{\\mu_i + \\sum_{j\\in\\set{E_1,E_2,I}}W_{ij}r_j(t) + \\sqrt{2\\sigma_i}\\xi_i(t)}_+, \\qquad \\text{for }i \\in \\set{E_1,E_2,I} \\] The solution is obtained as \\[ \\delta \\mathbf{r}(t) = \\exp\\left\\{-\\mathbf{M}t\\right\\}\\delta\\mathbf{r}(0) + \\int_{-\\infty}^{t}\\exp\\left\\{-\\mathbf{M}\\pa{t-t'}\\right\\}\\mathbf{D}\\ \\underbrace{d\\mathbf{W}(t')}_{\\boldsymbol{\\xi}(t')} \\] with mean \\(\\ang{\\delta \\mathbf{r}(t)} = \\exp\\set{-\\mathbf{M}t}\\ang{\\delta \\mathbf{r}(0)}\\) (expectation of integral is given by an Ito integral property ).","title":"Long-time covariance calculation"},{"location":"Long-time%20covariance%20calculation/#long-time-covariance-function","text":"We now compute the \\(t\\to \\infty\\) covariance function. Observe \\(\\lim_{t \\to \\infty} \\ang{\\delta \\mathbf{r}(t)} = 0\\) (see the Remark below for the details about this calculation). As an operator, \\(\\Cov(\\cdot, \\cdot)\\) is shift-invariant in each argument, thus \\[\\Cov(\\mathbf{r}(t), \\mathbf{r}(s)) = \\Cov(\\mathbf{r}(t)-\\mathbf{\\bar{r}}, \\mathbf{r}(s)-\\mathbf{\\bar{r}}) = \\Cov(\\delta \\mathbf{r}(t), \\delta\\mathbf{r}(s)).\\] Hence in the following calculations, for notational simplicity, we will use \\(\\mathbf{r}(t)\\) in place of \\(\\delta \\mathbf{r}(t)\\) . We make the notations \\[\\Cov(\\mathbf{r}(t), \\mathbf{r}(s)) =: \\ang{\\mathbf{r}(t), \\mathbf{r}(s)} = \\E\\bra{\\pa{\\mathbf{r}(t)-\\E\\bra{\\mathbf{r}(t)}}\\pa{\\mathbf{r}(s)-\\E\\bra{\\mathbf{r}(s)}}^\\top} = \\ang{\\pa{\\mathbf{r}(t) - \\ang{\\mathbf{r}(t)}}\\pa{\\mathbf{r}(s) - \\ang{\\mathbf{r}(s)}}^\\top}.\\] For \\(s=t+\\tau\\) where \\(\\tau > 0\\) , we have \\[\\begin{aligned} \\ang{\\pa{\\mathbf{r}(t)-\\ang{\\mathbf{r}(t)}}\\pa{\\mathbf{r}(t+\\tau)-\\ang{\\mathbf{r}(t+\\tau)}}^\\top} &= \\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(t+\\tau)-\\ang{\\mathbf{r}(t)}\\mathbf{r}^{\\top}(t+\\tau) - \\mathbf{r}(t)\\ang{\\mathbf{r}(t+\\tau)}^{\\top} + \\ang{\\mathbf{r}(t)}\\ang{\\mathbf{r}(t+\\tau)}^{\\top}}\\\\ &= \\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(t+\\tau)} - 2\\underbrace{\\ang{\\mathbf{r}(t)}\\ang{\\mathbf{r}^{\\top}(t+\\tau)}}_{\\xrightarrow[t\\to\\infty]{}0} + \\underbrace{\\ang{\\mathbf{r}(t)}\\ang{\\mathbf{r}(t+\\tau)}^{\\top}}_{\\xrightarrow[t\\to\\infty]{}0}, \\end{aligned} \\] which implies that the long-time covariance function is the \\(t\\to \\infty\\) limit of \\(\\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(t+\\tau)}\\) : \\[ \\begin{aligned} \\lim_{t\\to \\infty} \\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(t+\\tau)} &= \\lim_{t\\to\\infty} \\ang{ \\int_{-\\infty}^{t}\\int_{-\\infty}^{t+\\tau} \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D} \\pmb{\\xi}(t') \\pa{\\exp\\set{-\\mathbf{M}\\pa{t+\\tau-t''}}\\mathbf{D} \\pmb{\\xi}(t'')}^\\top \\ dt'' \\ dt' }\\\\ &= \\lim_{t\\to \\infty} \\int_{-\\infty}^{t}\\int_{-\\infty}^{t+\\tau} \\ang{ \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D} \\pmb{\\xi}(t') \\pmb{\\xi}^{\\top}(t'')\\mathbf{D}^{\\top}\\exp\\set{-\\mathbf{M}^{\\top}(t+\\tau-t'')}} \\ dt'' \\ dt' \\\\ &= \\lim_{t\\to \\infty} \\int_{-\\infty}^{t}\\int_{-\\infty}^{t+\\tau} \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D} \\ang{\\pmb{\\xi}(t') \\pmb{\\xi}^{\\top}(t'')}\\mathbf{D}^{\\top}\\exp\\set{-\\mathbf{M}^{\\top}(t+\\tau-t'')} \\ dt'' \\ dt' \\\\ &= \\lim_{t\\to\\infty} \\int_{-\\infty}^{t} \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D}\\mathbf{D}^{\\top}\\exp\\set{-\\mathbf{M}^{\\top}(t+\\tau-t')} \\ dt', \\end{aligned} \\] where in the last line we used that the white noise process \\(\\boldsymbol{\\xi}(t)\\) has a \\(\\delta\\) correlation in time.","title":"Long-time covariance function."},{"location":"Long-time%20covariance%20calculation/#the-lyapunov-equation","text":"Let \\(\\pmb{\\Sigma}:=\\ang{\\mathbf{r}(t),\\mathbf{r}^\\top(t)}\\) be the (instantaneous, at each \\(t\\) ) stationary covariance matrix. We may evaluate this quantity algebraically as \\[ \\begin{aligned} \\mathbf{M}\\pmb{\\Sigma} + \\pmb{\\Sigma}\\mathbf{M}^{\\top} &= \\int_{-\\infty}^{t}\\mathbf{M} \\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\mathbf{D}\\mathbf{D}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')} \\ dt' \\\\ &\\qquad \\qquad + \\int_{-\\infty}^{t} \\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\mathbf{D}\\mathbf{D}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')}\\mathbf{M}^{\\top} \\ dt'\\\\ &= \\int_{-\\infty}^{t} \\frac{d}{dt'}\\bra{\\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\mathbf{D}\\mathbf{D}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')}} \\ dt' \\\\ &= \\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\mathbf{D}\\mathbf{D}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')}\\Bigg|_{t'\\to -\\infty}^{t'=t} \\\\ &=\\exp\\set{0}\\mathbf{D}\\mathbf{D}^{\\top}\\exp\\set{0} - \\lim_{t'\\to -\\infty} \\pa{\\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\mathbf{D}\\mathbf{D}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')}}\\\\ &=\\mathbf{D}\\mathbf{D}^\\top. \\end{aligned} \\] This is called the Lyapunov equation . Remark In the last equality, we take limits \\lim_{t' \\to -\\infty} \\exp\\set{-\\mathbf{M}(t-t')} \\qquad \\text{and} \\qquad \\lim_{t' \\to -\\infty} \\exp\\set{-\\mathbf{M}^{\\top}(t-t')} which is equivalent to looking at \\(\\lim\\limits_{t\\to \\infty} e^{\\mathbf{M}t}\\) . Suppose \\(\\mathbf{M}\\) is diagonalizable: \\mathbf{M} = \\mathbf{U}^{-1}\\boldsymbol{\\Lambda}\\mathbf{U}, \\qquad \\boldsymbol{\\Lambda} = \\text{diag}\\pa{\\lambda_1,\\lambda_2,\\ldots,\\lambda_n} Then e^{t\\mathbf{M}} = \\mathbf{U}^{-1}e^{t\\boldsymbol{\\Lambda}}\\mathbf{U} = \\mathbf{U}^{-1}\\pa{\\text{diag}\\pa{e^{\\lambda_1t},e^{\\lambda_2t},\\ldots,e^{\\lambda_n t}}}\\mathbf{U}. This expression shows that the convergence as \\(t\\to \\infty\\) depends on eigenvalues. In particular, we need their real parts to be \\(<0\\) . In this case, \\(e^{t\\mathbf{A}} \\xrightarrow[t\\to\\infty]{} 0\\) . Because we assume the network is stable, \\(\\mathbf{M}\\) must have eigenvalues with positive real part. ^adf0fd","title":"The Lyapunov equation."},{"location":"Long-time%20covariance%20calculation/#time-correlation-matrix-in-stationary-state","text":"As computed above and using the fact that \\(\\mathbf{DD}^{\\top}= \\mathbf{M}\\bf{\\Sigma} + \\bf{\\Sigma}\\bf{M}^\\top\\) , if \\(t > s\\) , \\[ \\begin{aligned} \\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(s)} &= \\int_{-\\infty}^{s} \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D}\\mathbf{D}^{\\top}\\exp\\set{-\\mathbf{M}^{\\top}(s-t')} \\ dt' \\\\ &= \\int_{-\\infty}^{s} \\exp\\set{-\\mathbf{M}(t-t')} \\mathbf{M}\\boldsymbol{\\Sigma} \\exp\\set{-\\mathbf{M}^{\\top}(s-t')} \\ dt' \\\\ &\\qquad \\qquad + \\int_{-\\infty}^{s}\\exp\\set{-\\mathbf{M}(t-t')} \\boldsymbol{\\Sigma}\\mathbf{M}^{\\top} \\exp\\set{-\\mathbf{M}^{\\top}(s-t')} \\ dt'\\\\ &= \\int_{-\\infty}^{s} \\frac{d}{dt'} \\bra{\\exp\\set{-\\mathbf{M}(t-t')}\\boldsymbol{\\Sigma} \\exp\\set{-\\mathbf{M}^{\\top}(s-t')}} \\ dt' \\\\ &= \\exp\\set{-\\mathbf{M}\\pa{t-s}}\\boldsymbol{\\Sigma} - \\lim_{t'\\to-\\infty} \\exp\\set{-\\mathbf{M}\\pa{t-t'}} \\boldsymbol{\\Sigma} \\exp\\set{-\\mathbf{M}^\\top\\pa{s-t'}}\\\\ &= \\exp\\set{-\\mathbf{M}\\pa{t-s}}\\boldsymbol{\\Sigma}. \\end{aligned} \\] Likewise, if \\(s > t\\) , \\[\\begin{aligned} \\ang{\\mathbf{r}(t)\\mathbf{r}^{\\top}(s)} &= \\int_{-\\infty}^{t} \\exp\\set{-\\mathbf{M}(t-t')}\\mathbf{D}\\mathbf{D}^{\\top}\\exp\\set{-\\mathbf{M}^{\\top}(s-t')} \\ dt' \\\\ &= \\int_{-\\infty}^{t} \\frac{d}{dt'} \\bra{\\exp\\set{-\\mathbf{M}(t-t')}\\boldsymbol{\\Sigma} \\exp\\set{-\\mathbf{M}^{\\top}(s-t')}} \\ dt' \\\\ &= \\boldsymbol{\\Sigma}\\exp\\set{-\\mathbf{M}^{\\top}(s-t)}. \\end{aligned}\\] Note As expected of a stationary solution, the correlation function depends only on time lag \\(h=|s-t|\\) . Define \\(\\widetilde{\\mathbf{C}}(t-s) = \\ang{\\mathbf{r}(t),\\mathbf{r}^{\\top}(s)}\\) . If \\(h = s-t\\) , Then we may write \\[ \\widetilde{\\mathbf{C}}(h) = \\begin{cases} \\exp\\set{\\mathbf{M}h}\\boldsymbol{\\Sigma}, & h <0\\\\[10pt] \\boldsymbol{\\Sigma}\\exp\\set{-\\mathbf{M}^{\\top}h}, & h > 0 \\end{cases} \\]","title":"Time correlation matrix in stationary state."},{"location":"Long-time%20covariance%20calculation/#long-time-covariance-matrix","text":"The spectrum matrix is the Fourier transform of the correlation matrix, \\[ \\begin{aligned} \\mathbf{S}(\\omega) = \\int_{-\\infty}^{\\infty} e^{-2\\pi i\\omega h} \\widetilde{\\mathbf{C}}(h)\\ dh. \\end{aligned} \\] Then \\(\\mathbf{S}(0)=\\int_{-\\infty}^\\infty \\mathbf{\\tilde{C}}(h) \\ dh\\) . We may also compute this as follows: \\[\\begin{aligned} \\mathbf{S}(0) &= \\int_0^{\\infty} \\boldsymbol{\\Sigma}\\exp\\set{-\\mathbf{M}^{\\top}h} \\ dh + \\int_{-\\infty}^{0}\\exp\\set{\\mathbf{M}h}\\boldsymbol{\\Sigma} \\ dh \\\\ &= \\boldsymbol{\\Sigma}\\pa{\\mathbf{M}^{\\top}}^{-1} + \\mathbf{M}^{-1}\\boldsymbol{\\Sigma}, \\end{aligned}\\] and so \\[\\mathbf{M}\\mathbf{S}(0)\\mathbf{M}^{\\top} = \\mathbf{M}\\boldsymbol{\\Sigma} + \\boldsymbol{\\Sigma}\\mathbf{M}^{\\top}= \\mathbf{DD}^\\top\\] This gives \\[ \\int_{-\\infty}^{\\infty} \\widetilde{\\mathbf{C}}(h) \\ dh =\\mathbf{S}(0) = \\mathbf{M}^{-1}\\mathbf{D}\\mathbf{D}^\\top\\pa{\\mathbf{M}^{\\top}}^{-1} = \\mathbf{M}^{-1}\\mathbf{D}\\pa{\\mathbf{M}^{-1}\\mathbf{D}}^\\top. \\] We define the long-time covariance precisely this quantity: \\[ \\mathbf{C}:=\\int_{-\\infty}^{\\infty} \\widetilde{\\mathbf{C}}(h) \\ dh = \\mathbf{M}^{-1}\\mathbf{D}\\pa{\\mathbf{M}^{-1}\\mathbf{D}}^\\top. \\]","title":"Long-time covariance matrix."},{"location":"Rate%20model%20setup/","text":"\\[ \\DeclareMathOperator{\\Cov}{Cov} \\DeclareMathOperator{\\Corr}{Corr} \\DeclareMathOperator{\\Var}{Var} \\DeclareMathOperator{\\prob}{\\mathbb{P}} \\DeclareMathOperator{\\qprob}{\\mathbb{Q}} \\DeclareMathOperator{\\E}{\\mathbb{E}} \\newcommand{\\set}[1]{\\left\\{#1\\right\\}} \\newcommand{\\pa}[1]{\\left(#1\\right)} \\newcommand{\\ang}[1]{\\left<#1\\right>} \\newcommand{\\bra}[1]{\\left[#1\\right]} \\newcommand{\\abs}[1]{\\left|#1\\right|} \\newcommand{\\norm}[1]{\\left\\|#1\\right\\|} \\] Three unit rate model \u00b6 Three-unit model. \u00b6 Neurons \\(\\set{E_1,E_2,E_I}\\) evolve with dynamics described by \\[ \\tau_i \\dot{r}_i(t) = - r_i(t) + \\bra{\\mu_i + \\sum_{j\\in\\set{E_1,E_2,I}}W_{ij}r_j(t) + \\sqrt{2\\sigma_i}\\xi_i(t)}_+, \\qquad \\text{for }i \\in \\set{E_1,E_2,I} \\] ^0898d9 where: \\(\\xi_i(t)\\) are mutually independent white noise processes, \\(\\tau_i\\) are time constants \\(\\sigma_i\\) is the noise magnitude \\(\\mu_i\\) is stimulus input to \\(i\\) \\(\\bra{\\cdot}_+ : \\mathbb{R} \\to \\mathbb{R}\\) is defined via \\(\\bra{\\cdot}\\equiv \\max\\set{\\cdot, 0}\\) We may drop the \\(\\bra{\\cdot}_+\\) under the assumption that the threshold is never sampled for sufficiently strong inputs. Weak cross-excitatory connection. \u00b6 To implement a weak \\(E_1 \\leftrightarrow E_2\\) connection, we introduce a parameter \\(\\alpha \\in \\pa{0,1}\\) which scales inter-excitatory connections \\(W_{E_1E_2}\\) , \\(W_{E_2E_1}\\) with respect to the intra-excitatory connections \\(W_{E_1E_1}, W_{E_2E_2}\\) respectively. Refer to the following sketch of the network setup for the three unit \\(\\set{E_1,E_2,I}\\) case: In vector form, the dynamical equations are \\[\\begin{aligned} \\underbrace{\\begin{bmatrix} \\tau_{E_1} & 0 & 0 \\\\ 0 & \\tau_{E_2} & 0 \\\\ 0 & 0 & \\tau_I \\end{bmatrix}}_{\\boldsymbol{\\tau}} \\begin{bmatrix} \\dot{r}_{E_1} \\\\ \\dot{r}_{E_2} \\\\ \\dot{r}_{I} \\end{bmatrix} = - \\underbrace{\\begin{bmatrix} r_{E_1} \\\\ r_{E_2} \\\\ r_{I} \\end{bmatrix}}_{\\mathbf{r}} + \\underbrace{\\begin{bmatrix} \\mu_{E_1} \\\\ \\mu_{E_2} \\\\ \\mu_I \\end{bmatrix}}_{\\pmb{\\mu}} & + \\underbrace{\\begin{bmatrix} W_{E_1E_1} & W_{E_1E_2} & -W_{E_1I} \\\\ W_{E_2E_1} & W_{E_2E_2} & - W_{E_2I} \\\\ W_{IE_1} & W_{IE_2} & -W_{II} \\end{bmatrix}}_{\\mathbf{W}} \\begin{bmatrix} r_{E_1} \\\\ r_{E_2}\\\\ r_I \\end{bmatrix} \\\\ & \\qquad + \\sqrt{2} \\underbrace{\\begin{bmatrix} \\sqrt{\\sigma_{E_1}} & 0 & 0 \\\\ 0 & \\sqrt{\\sigma_{E_2}} & 0 \\\\ 0 & 0 & \\sqrt{\\sigma_{I}} \\end{bmatrix}}_{\\mathbf{S}} \\underbrace{\\begin{bmatrix} \\xi_{E_1} \\\\ \\xi_{E_2}\\\\ \\xi_I \\end{bmatrix}}_{\\pmb{\\xi}} \\end{aligned}\\] which can be written compactly as \\pmb{\\tau} \\mathbf{\\dot{r}} = \\pmb{\\mu} + \\pa{-\\mathbf{1} + \\mathbf{W}}\\mathbf{r} + \\sqrt{2}\\mathbf{S} \\pmb{\\xi}. In the absence of noise, given \\(\\mathbf{\\bar{r}}\\) we can solve for \\(\\pmb{\\mu}\\) at the steady state (i.e., \\(\\mathbf{\\dot{r}}=0\\) ) \\pmb{\\mu} = \\pa{\\mathbf{1} - \\mathbf{W}}\\mathbf{\\bar{r}}. Let \\(\\delta \\mathbf{r} = \\mathbf{r}-\\mathbf{\\bar{r}}\\) denote the rates' fluctuations about their steady states. Then for sufficiently small noise, \\(\\delta \\mathbf{r}\\) is an Ornstein-Uhlenbeck process given as the solution to the linear SDE \\frac{d}{dt}\\delta \\mathbf{r} = -\\underbrace{\\pmb{\\tau}^{-1}\\pa{\\mathbf{1}-\\mathbf{W}}}_{\\mathbf{M}}\\delta \\mathbf{r} + \\underbrace{\\sqrt{2} \\pmb{\\tau}^{-1} \\mathbf{S}}_{\\mathbf{D}} \\pmb{\\xi} = -\\mathbf{M} \\delta \\mathbf{r} + \\mathbf{D} \\pmb{\\xi}. ^e90dac Four-unit model. \u00b6 The modeling setup for the three-unit network generalizes to \\(N_E\\) excitatory and \\(N_I\\) inhibitory neurons for a total of \\(N = N_E + N_I\\) neurons. We will also be considering an \\(N=4\\) neuron model with \\(\\set{E_1,E_2,I_1,I_2}\\) as the neurons. ![[img/sketch-four_unit_setup.png]] The dynamical equations for the four-unit model are identical to those of the three-unit model, only now we have additional variables to account for each of \\(I_1, I_2\\) . Note that the weight matrix is \\[ \\mathbf{W} = \\begin{bmatrix} W_{E_1E_1} & \\alpha W_{E_2E_2} & - W_{E_1I_1} & -\\beta W_{E_2I_2} \\\\ \\alpha W_{E_1E_1} & W_{E_2E_2} & - \\beta W_{E_1I_1} & - W_{E_2I_2} \\\\ W_{I_1E_1} & \\gamma W_{I_2E_2} & - W_{I_1I_1} & -\\zeta W_{I_2I_2} \\\\ \\gamma W_{I_1E_1} & W_{I_2E_2} & - \\zeta W_{I_1I_1} & -W_{I_2I_2} \\end{bmatrix}. \\] Stability analysis \u00b6 ^6c6a55 For simplicity, assume \\(\\boldsymbol{\\tau}=\\mathbf{1}\\) and \\(\\boldsymbol{\\mu} = 0\\) . Assume there is no noise in the system, so that we are solving \\[ \\mathbf{\\dot{r}}(t) = \\pa{-\\mathbf{1}+\\mathbf{W}}\\mathbf{r}(t). \\] Since this is a linear equation, we seek solutions of the form \\[ \\mathbf{r}(t) = \\mathbf{v}e^{\\lambda t}, \\qquad \\mathbf{v} \\in \\mathbb{R}^{3}\\text{ is a constant vector} \\] Then: \\pa{-\\mathbf{1}+\\mathbf{W}}\\mathbf{v}e^{\\lambda t} = \\pa{-\\mathbf{1}+ \\mathbf{W}}\\mathbf{r}(t)=\\mathbf{\\dot{r}}(t) = \\lambda\\mathbf{v} e^{\\lambda t} \\implies \\pa{-\\mathbf{1}+\\mathbf{W}}\\mathbf{v}=\\lambda \\mathbf{v}, that is, \\(\\lambda\\) must be an eigenvalue of \\(-\\mathbf{1} + \\mathbf{W}\\) , and \\(\\mathbf{v}\\) a corresponding eigenvector. The eigenvalues are obtained by solving \\[ \\pa{-\\mathbf{1}+\\mathbf{W}}\\mathbf{v} - \\lambda \\mathbf{v} = \\pa{-\\mathbf{1} + \\mathbf{W} - \\lambda \\mathbf{1}}\\mathbf{v} = 0. \\]","title":"Rate model setup"},{"location":"Rate%20model%20setup/#three-unit-rate-model","text":"","title":"Three unit rate model"},{"location":"Rate%20model%20setup/#three-unit-model","text":"Neurons \\(\\set{E_1,E_2,E_I}\\) evolve with dynamics described by \\[ \\tau_i \\dot{r}_i(t) = - r_i(t) + \\bra{\\mu_i + \\sum_{j\\in\\set{E_1,E_2,I}}W_{ij}r_j(t) + \\sqrt{2\\sigma_i}\\xi_i(t)}_+, \\qquad \\text{for }i \\in \\set{E_1,E_2,I} \\] ^0898d9 where: \\(\\xi_i(t)\\) are mutually independent white noise processes, \\(\\tau_i\\) are time constants \\(\\sigma_i\\) is the noise magnitude \\(\\mu_i\\) is stimulus input to \\(i\\) \\(\\bra{\\cdot}_+ : \\mathbb{R} \\to \\mathbb{R}\\) is defined via \\(\\bra{\\cdot}\\equiv \\max\\set{\\cdot, 0}\\) We may drop the \\(\\bra{\\cdot}_+\\) under the assumption that the threshold is never sampled for sufficiently strong inputs.","title":"Three-unit model."},{"location":"Rate%20model%20setup/#weak-cross-excitatory-connection","text":"To implement a weak \\(E_1 \\leftrightarrow E_2\\) connection, we introduce a parameter \\(\\alpha \\in \\pa{0,1}\\) which scales inter-excitatory connections \\(W_{E_1E_2}\\) , \\(W_{E_2E_1}\\) with respect to the intra-excitatory connections \\(W_{E_1E_1}, W_{E_2E_2}\\) respectively. Refer to the following sketch of the network setup for the three unit \\(\\set{E_1,E_2,I}\\) case: In vector form, the dynamical equations are \\[\\begin{aligned} \\underbrace{\\begin{bmatrix} \\tau_{E_1} & 0 & 0 \\\\ 0 & \\tau_{E_2} & 0 \\\\ 0 & 0 & \\tau_I \\end{bmatrix}}_{\\boldsymbol{\\tau}} \\begin{bmatrix} \\dot{r}_{E_1} \\\\ \\dot{r}_{E_2} \\\\ \\dot{r}_{I} \\end{bmatrix} = - \\underbrace{\\begin{bmatrix} r_{E_1} \\\\ r_{E_2} \\\\ r_{I} \\end{bmatrix}}_{\\mathbf{r}} + \\underbrace{\\begin{bmatrix} \\mu_{E_1} \\\\ \\mu_{E_2} \\\\ \\mu_I \\end{bmatrix}}_{\\pmb{\\mu}} & + \\underbrace{\\begin{bmatrix} W_{E_1E_1} & W_{E_1E_2} & -W_{E_1I} \\\\ W_{E_2E_1} & W_{E_2E_2} & - W_{E_2I} \\\\ W_{IE_1} & W_{IE_2} & -W_{II} \\end{bmatrix}}_{\\mathbf{W}} \\begin{bmatrix} r_{E_1} \\\\ r_{E_2}\\\\ r_I \\end{bmatrix} \\\\ & \\qquad + \\sqrt{2} \\underbrace{\\begin{bmatrix} \\sqrt{\\sigma_{E_1}} & 0 & 0 \\\\ 0 & \\sqrt{\\sigma_{E_2}} & 0 \\\\ 0 & 0 & \\sqrt{\\sigma_{I}} \\end{bmatrix}}_{\\mathbf{S}} \\underbrace{\\begin{bmatrix} \\xi_{E_1} \\\\ \\xi_{E_2}\\\\ \\xi_I \\end{bmatrix}}_{\\pmb{\\xi}} \\end{aligned}\\] which can be written compactly as \\pmb{\\tau} \\mathbf{\\dot{r}} = \\pmb{\\mu} + \\pa{-\\mathbf{1} + \\mathbf{W}}\\mathbf{r} + \\sqrt{2}\\mathbf{S} \\pmb{\\xi}. In the absence of noise, given \\(\\mathbf{\\bar{r}}\\) we can solve for \\(\\pmb{\\mu}\\) at the steady state (i.e., \\(\\mathbf{\\dot{r}}=0\\) ) \\pmb{\\mu} = \\pa{\\mathbf{1} - \\mathbf{W}}\\mathbf{\\bar{r}}. Let \\(\\delta \\mathbf{r} = \\mathbf{r}-\\mathbf{\\bar{r}}\\) denote the rates' fluctuations about their steady states. Then for sufficiently small noise, \\(\\delta \\mathbf{r}\\) is an Ornstein-Uhlenbeck process given as the solution to the linear SDE \\frac{d}{dt}\\delta \\mathbf{r} = -\\underbrace{\\pmb{\\tau}^{-1}\\pa{\\mathbf{1}-\\mathbf{W}}}_{\\mathbf{M}}\\delta \\mathbf{r} + \\underbrace{\\sqrt{2} \\pmb{\\tau}^{-1} \\mathbf{S}}_{\\mathbf{D}} \\pmb{\\xi} = -\\mathbf{M} \\delta \\mathbf{r} + \\mathbf{D} \\pmb{\\xi}. ^e90dac","title":"Weak cross-excitatory connection."},{"location":"Rate%20model%20setup/#four-unit-model","text":"The modeling setup for the three-unit network generalizes to \\(N_E\\) excitatory and \\(N_I\\) inhibitory neurons for a total of \\(N = N_E + N_I\\) neurons. We will also be considering an \\(N=4\\) neuron model with \\(\\set{E_1,E_2,I_1,I_2}\\) as the neurons. ![[img/sketch-four_unit_setup.png]] The dynamical equations for the four-unit model are identical to those of the three-unit model, only now we have additional variables to account for each of \\(I_1, I_2\\) . Note that the weight matrix is \\[ \\mathbf{W} = \\begin{bmatrix} W_{E_1E_1} & \\alpha W_{E_2E_2} & - W_{E_1I_1} & -\\beta W_{E_2I_2} \\\\ \\alpha W_{E_1E_1} & W_{E_2E_2} & - \\beta W_{E_1I_1} & - W_{E_2I_2} \\\\ W_{I_1E_1} & \\gamma W_{I_2E_2} & - W_{I_1I_1} & -\\zeta W_{I_2I_2} \\\\ \\gamma W_{I_1E_1} & W_{I_2E_2} & - \\zeta W_{I_1I_1} & -W_{I_2I_2} \\end{bmatrix}. \\]","title":"Four-unit model."},{"location":"Rate%20model%20setup/#stability-analysis","text":"^6c6a55 For simplicity, assume \\(\\boldsymbol{\\tau}=\\mathbf{1}\\) and \\(\\boldsymbol{\\mu} = 0\\) . Assume there is no noise in the system, so that we are solving \\[ \\mathbf{\\dot{r}}(t) = \\pa{-\\mathbf{1}+\\mathbf{W}}\\mathbf{r}(t). \\] Since this is a linear equation, we seek solutions of the form \\[ \\mathbf{r}(t) = \\mathbf{v}e^{\\lambda t}, \\qquad \\mathbf{v} \\in \\mathbb{R}^{3}\\text{ is a constant vector} \\] Then: \\pa{-\\mathbf{1}+\\mathbf{W}}\\mathbf{v}e^{\\lambda t} = \\pa{-\\mathbf{1}+ \\mathbf{W}}\\mathbf{r}(t)=\\mathbf{\\dot{r}}(t) = \\lambda\\mathbf{v} e^{\\lambda t} \\implies \\pa{-\\mathbf{1}+\\mathbf{W}}\\mathbf{v}=\\lambda \\mathbf{v}, that is, \\(\\lambda\\) must be an eigenvalue of \\(-\\mathbf{1} + \\mathbf{W}\\) , and \\(\\mathbf{v}\\) a corresponding eigenvector. The eigenvalues are obtained by solving \\[ \\pa{-\\mathbf{1}+\\mathbf{W}}\\mathbf{v} - \\lambda \\mathbf{v} = \\pa{-\\mathbf{1} + \\mathbf{W} - \\lambda \\mathbf{1}}\\mathbf{v} = 0. \\]","title":"Stability analysis"}]}